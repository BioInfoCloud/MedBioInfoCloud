% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ImmuCellAI_mouse.R
\name{sample_ratio}
\alias{sample_ratio}
\title{Calculate Sample-Specific Marker Gene Ratio}
\usage{
sample_ratio(
  data,
  marker_exp,
  marker_tag_mat,
  data_type,
  gene_weight_mt,
  ref_pre,
  cell_cor_new_mat
)
}
\arguments{
\item{data}{Gene expression vector for a single sample (numeric).}

\item{marker_exp}{Reference marker expression matrix (rows = genes, columns = cell types).}

\item{marker_tag_mat}{Binary tag matrix (rows = genes, columns = cell types) from `marker_tag()`.}

\item{data_type}{Type of input data. One of "rnaseq" or "microarray".}

\item{gene_weight_mt}{Gene weight matrix from `gene_ref_weight_mt()` (not used in current implementation).}

\item{ref_pre}{Pre-computed SSGSEA result of reference data (not used in current implementation).}

\item{cell_cor_new_mat}{Cell correlation matrix (not used in current implementation).}
}
\value{
Numeric vector of normalized gene ratios (length = number of genes in `data`).
}
\description{
Internal helper function to compute the ratio of sample gene expression to reference marker expression,
weighted by a binary tag matrix (indicating marker genes for each cell type).
}
\examples{
# Example sample data (5 genes)
sample_data <- c(12, 9, 4, 7, 5)

# Reference marker expression (5 genes, 2 cell types)
ref_marker <- matrix(c(10, 8, 0, 6, 0, 0, 0, 10, 0, 8), nrow = 5, ncol = 2,
                     dimnames = list(c("G1", "G2", "G3", "G4", "G5"), c("Tcell", "Bcell")))

# Binary tag matrix (5 genes, 2 cell types)
tag_mat <- cbind(c(1,1,0,1,0), c(0,0,1,0,1))

# Calculate sample ratio
ratio <- sample_ratio(
  data = sample_data,
  marker_exp = ref_marker,
  marker_tag_mat = tag_mat,
  data_type = "rnaseq",
  gene_weight_mt = NULL,
  ref_pre = NULL,
  cell_cor_new_mat = NULL
)
}
