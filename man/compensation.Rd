% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ImmuCellAI_mouse.R
\name{compensation}
\alias{compensation}
\title{Adjust Immune Cell Abundance with Compensation Matrix}
\usage{
compensation(raw_score, compensation_matrix)
}
\arguments{
\item{raw_score}{Raw SSGSEA score matrix (rows = samples, columns = cell types).}

\item{compensation_matrix}{Compensation matrix (rows/columns = cell types) for adjusting cross-cell interference.}
}
\value{
Adjusted abundance matrix. Rows = cell types, columns = samples. Values are non-negative.
}
\description{
Internal helper function to adjust raw SSGSEA scores using a compensation matrix,
minimizing cross-reactivity between different cell types via constrained least squares.
}
\examples{
# Example raw SSGSEA scores (2 samples, 3 cell types)
raw_score <- matrix(c(0.8, 0.6, 0.2, 0.7, 0.5, 0.3), nrow = 2, ncol = 3,
                    dimnames = list(c("Sample1", "Sample2"), c("Tcell", "Bcell", "DC")))

# Example compensation matrix (3x3)
comp_matrix <- matrix(c(1, 0.1, 0.05, 0.1, 1, 0.03, 0.05, 0.03, 1), nrow = 3, ncol = 3,
                      dimnames = list(colnames(raw_score), colnames(raw_score)))

# Run compensation
adjusted_score <- compensation(raw_score, comp_matrix)
}
