% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preGeneExpMatrixFromTCGA.R
\name{preGeneExpMatrixFromTCGA}
\alias{preGeneExpMatrixFromTCGA}
\title{Extract gene expression matrix from TCGA data with gene type and list filtering}
\usage{
preGeneExpMatrixFromTCGA(
  dataFolder,
  cancer,
  type = "tpm",
  genes = NULL,
  keep_genes = TRUE,
  filter = NULL,
  pattern = "STARdata.Rdata$"
)
}
\arguments{
\item{dataFolder}{Character string. Path to the folder containing TCGA expression data files.}

\item{cancer}{Character string. TCGA cancer type abbreviation (e.g., "LUAD", "BRCA").}

\item{type}{Character string. Type of expression data to extract: "tpm" (transcripts per million) or "count" (read counts). Defaults to "tpm".}

\item{genes}{Character vector. Genes of interest to filter. If NULL (default), no gene list filtering is applied (returns all genes passing type filter).}

\item{keep_genes}{Logical. Only effective when `genes` is not NULL. If TRUE, retain genes in `genes`; if FALSE, remove genes in `genes` and keep others. Defaults to TRUE.}

\item{filter}{Gene type(s) to retain. Can be: 
- NULL (default): retain all gene types (no filtering by type).
- Character string or vector: retain genes where `gene_type` matches these values (e.g., "protein_coding", c("lncRNA", "miRNA")).
Common values include "protein_coding", "lncRNA", "snRNA", "miRNA", "misc_RNA" (see details for full list).}

\item{pattern}{Character string. Regular expression pattern to match data files (default: "STARdata.Rdata$").}
}
\value{
A matrix with genes as rows and samples as columns, containing the filtered expression values.
}
\description{
This function loads TCGA gene expression data (TPM or count), filters genes by type (e.g., protein-coding) and/or a specified gene list,
and returns the processed matrix with control over retaining or removing the specified genes.
}
\details{
- Gene type filtering (via `filter`) is applied first: only genes with `gene_type` in `filter` (or all genes if `filter = FALSE`) are retained.
- Gene list filtering (via `genes` and `keep_genes`) is applied next: 
  - If `genes = NULL`, returns all genes passing the type filter.
  - If `genes` is provided, retains/removes these genes from the type-filtered results (based on `keep_genes`).
- Common gene types include: "protein_coding", "lncRNA", "snRNA", "miRNA", "misc_RNA", "snoRNA", "rRNA", etc.
}
